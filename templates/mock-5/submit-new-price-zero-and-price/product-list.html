{% extends "base.html" %}
{% block title %}
Submit a new product | Portal | NHSBSA
{% endblock %}
{% block content %}

<div class="nhsuk-back-link nhsuk-u-margin-bottom-4">
  <a class="nhsuk-back-link__link" href="product-list-add">
    <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
      <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
    </svg>
    Go back to select products or individual packs</a>
</div>

<h1>
  <span class="nhsuk-caption-l">
     Price change submission
     <span class="nhsuk-u-visually-hidden"> - </span>
   </span>Selected packs</h1>

<p class="nhsuk-u-margin-bottom-6" id="pack-review">Review all selected packs. You can add or remove packs as required.</p>

<div id="price-change-clear-all">

  <div class="nhsuk-body-m flex--space-between" style="display: flex">
    <div class="nhsuk-u-visually-hidden">Currently viewing</div>
    <div id="pageAndResultCount">Page 1 of 1 (3 results)</div>
  </div>

  <table role="table" class="nhsuk-table-responsive nhsuk-u-margin-bottom-4" id="price-change-table">
    <caption id="table-caption">Selected packs for price change</caption>
    <thead role="rowgroup" class="nhsuk-table__head">
    <tr role="row">
      <th role="columnheader" class="" scope="col">
        Product name
      </th>
      <th role="columnheader" class="" scope="col">
        Pack
      </th>
      <th role="columnheader" class="" scope="col">
        Subpack
      </th>
      <th role="columnheader" class="" scope="col">
        Price
      </th>
      <th role="columnheader" class="" scope="col">
        Action
      </th>
    </tr>
    </thead>
    <tbody class="nhsuk-table__body">
    <tr role="row" class="nhsuk-table__row">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>Alprazolam
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>30
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>
        <span class="nhsuk-u-visually-hidden">No Subpack information</span>
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>279</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" id="price-change-link-number-1" href="#">Remove</a>
      </td>
    </tr>
    <tr role="row" class="nhsuk-table__row" id="price-change-2">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>Bupenorphine 100mg capsules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>28
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>
        <span class="nhsuk-u-visually-hidden">No Subpack information</span>
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>233</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" href="#" id="price-change-link-number-2">Remove</a>
      </td>
    </tr>
    <tr role="row" class="nhsuk-table__row" id="zero-price-change-3">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>
        Cymbalta 30mg gastro-resistant capsules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>30
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>3 &times; 10 capsules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>315</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" href="#" id="price-change-link-number-3">Remove</a>
      </td>
    </tr>
    <tr role="row" class="nhsuk-table__row">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>Diamorphine 10mg tablets
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>100
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>
        <span class="nhsuk-u-visually-hidden">No Subpack information</span>
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>162</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" id="price-change-link-number-5" href="#">Remove</a>
      </td>
    </tr>
    <tr role="row" class="nhsuk-table__row" id="price-change-5">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>Methadone 50mg/5ml solution for injection ampoules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>10
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>
        <span class="nhsuk-u-visually-hidden">No Subpack information</span>
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>222</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" href="#" id="price-change-link-number-6">Remove</a>
      </td>
    </tr>
    <tr role="row" class="nhsuk-table__row" id="zero-price-change-7">
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Product name </span>Piroxicam 20mg capsules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Pack </span>30
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Subpack </span>
        5 &times; 4 capsules
      </td>
      <td role="cell" class="nhsuk-table__cell">
        <span class="nhsuk-table-responsive__heading">Price </span><span><span>453</span>p</span>
      </td>
      <td>
        <span class="nhsuk-table-responsive__heading">Action </span>
        <a class="nhsuk-link nhsuk-link--no-visited-state" href="#" id="price-change-link-number-7">Remove</a>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div class="nhsuk-inset-text" id="inset-text-no-packs">
  <span class="nhsuk-u-visually-hidden">Information: </span>
  <p>If you are missing any packs then <a href="product-list-add" class="nhsuk-link nhsuk-link--no-visited-state" onclick="addMorePacks()">add more packs</a></p>
  <p>If you no longer need all packs then <a class="nhsuk-link nhsuk-link--no-visited-state" href="#" onclick="removeAllEntries()">remove all selected packs</a></p>
</div>
<a class="nhsuk-button nhsuk-u-margin-right-0" href="input-price" id="continue-button">Continue</a>

<script>
  function addMorePacks() {
    localStorage.setItem("add-more-packs", "yes");
  }

  function priceChangeAddBlank() {
    localStorage.removeItem("add-more-packs");
 }

  let priceChangeClearAll = document.getElementById("price-change-clear-all");
  let packReviewText = document.getElementById("pack-review");

    function removeAllEntries() {
     priceChangeClearAll.style.display = "none";
     packReviewText.style.display = "none";
     document.getElementById("continue-button").style.display = "none";
     document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
     document.getElementById("inset-text-no-packs").innerHTML =
     '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
};

  let removePriceChangeNumberOne = document.getElementById("price-change-link-number-1");
  let removeRowOne = document.getElementById("price-change-1");
  let priceChangeTable = document.getElementById("price-change-table");

   removePriceChangeNumberOne.addEventListener("click", function(e) {
        // e.target was the clicked element
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        console.log('allRows 1', allRows.length);
        if (allRows.length <= 3 && allRows.length > 1) {
           priceChangeTable.deleteRow(1);
        } else if (allRows.length < 2){
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }

});

  removePriceChangeNumberOne.addEventListener("keydown", function(e) {
        // e.target was the clicked element
        if (e.key == 'Enter' || e.code == 'Space') {
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        if (allRows.length <= 3 && allRows.length > 1) {
           priceChangeTable.deleteRow(1);
        } else if (allRows.length < 2){
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }
      }
});

  let removePriceChangeNumberTwo = document.getElementById("price-change-link-number-2");
  let removeRowTwo = document.getElementById("price-change-2");

  removePriceChangeNumberTwo.addEventListener("click", function(e) {
        // e.target was the clicked element
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        console.log('allRows 2', allRows.length);
        if (allRows.length <= 3 && allRows.length > 1) {
           priceChangeTable.deleteRow(2);
        } else if (allRows.length < 2){
        console.log('under 2 rows');
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }
});

  removePriceChangeNumberTwo.addEventListener("keydown", function(e) {
        // e.target was the clicked element
        if (e.key == 'Enter' || e.code == 'Space') {
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        console.log('allRows', allRows.length);
        if (allRows.length <= 3 && allRows.length > 1) {
           priceChangeTable.deleteRow(2);
        } else if (allRows.length < 2){
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }
      }
});

  let removePriceChangeNumberThree = document.getElementById("price-change-link-number-3");
  let removeRowThree = document.getElementById("price-change-3");

if (removePriceChangeNumberThree) {
  removePriceChangeNumberThree.addEventListener("click", function(e) {
        // e.target was the clicked element
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        console.log('allRows 3', allRows.length);
        if (allRows.length == 2) {
           priceChangeTable.deleteRow(2);
        } else if (allRows.length == 3) {
           priceChangeTable.deleteRow(3);
        } else if (allRows.length <= 1){
        console.log('under 2 rows #3');
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }
});

  removePriceChangeNumberThree.addEventListener("keydown", function(e) {
        // e.target was the clicked element
        if (e.key == 'Enter' || e.code == 'Space') {
        let allRows = document.getElementsByClassName("nhsuk-table__row");
        if (allRows.length == 2) {
           priceChangeTable.deleteRow(2);
        } else if (allRows.length == 3) {
           priceChangeTable.deleteRow(3);
        } else if (allRows.length <= 1){
           priceChangeClearAll.style.display = "none";
           packReviewText.style.display = "none";
           document.getElementById("continue-button").style.display = "none";
           document.getElementById("inset-text-no-packs").style = "margin-top: 8px";
           document.getElementById("inset-text-no-packs").innerHTML =
           '<span class="nhsuk-u-visually-hidden">Information: </span><p>No packs selected for this price change.</p><p>To continue, <a href="product-list-search" onclick="priceChangeAddBlank()" class="nhsuk-link nhsuk-link--no-visited-state">add packs for this price change</a></p>';
        }
      }
});

}

</script>


{% endblock %}